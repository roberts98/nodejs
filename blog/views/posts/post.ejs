<% include ../partials/header %>

<div class="container-fluid">
    <div class="row">
        <div class="col-md-8">
            <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                    <% let i = 0 %>
                    <% post.forEach(function(post) { i++;%>
                    <% if (i === 1) { %>
                        <div class="carousel-item active">
                            <div class="carousel-caption d-none d-md-block rounded">
                                <h5><%= post.name %></h5>
                                <p><%- post.content.substring(0, 100) %></p>
                            </div>
                            <img class="d-block w-100" height="400px" src="<%= post.image %>" alt="Slide">
                        </div>
                    <% } else { %>
                        <div class="carousel-item">
                            <div class="carousel-caption d-none d-md-block rounded">
                                <h4><%= post.name %></h4>
                                <p><%- post.content.substring(0, 175) %></p>
                            </div>
                            <img class="d-block w-100" height="400px" src="<%= post.image %>" alt="Slide">
                        </div>
                        <% } %>
                    <% }); %>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>  
                <div class="row">
                    <% post.forEach(function(post) { %>
                        <div class="col-md-4 py-2">
                            <div class="card h-100" style="width: 18rem;">
                                <img class="card-img-top" src="<%= post.image %>" alt="Card image cap">
                                <div class="card-body d-flex flex-column">
                                    <% if (post.name.length > 40) { %> 
                                        <h5 class="card-title"><%= post.name.substring(0, 40) %>...</h5>
                                    <% } else { %>
                                        <h5 class="card-title"><%= post.name %></h5>
                                    <% } %>
                                    <p class="card-text"><em><%= post.created.getDate() %>/<%= post.created.getMonth() %>/<%= post.created.getFullYear() %> at <%= post.created.getHours() %>:<%= post.created.getMinutes() %></em> by <strong><%= post.author.username %></strong></p>
                                    <p class="card-text"><%- post.content.substring(0, 100) %>...</p>
                                    <a href="/post/<%= post.id %>" class="btn btn-primary mt-auto">Read more!</a>
                                </div>
                            </div>
                        </div>
                    <% }); %>
                </div>
        </div>
        <div class="col md-4">
            <% comment.forEach(function(comment) { %>
            <h3><%= comment.content %></h3>
            <% }); %>
        </div>
    </div>
</div>

<% include ../partials/footer %>